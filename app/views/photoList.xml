<Alloy>
  <Collection id="photoRecord" src="photoRecord" instance="true" />
  <Collection id="cropCollection" src="crop" instance="true" />
  <Collection id="workCollection" src="work" instance="true" />

  <Tab title="写真一覧" icon="/icons/images.png">
    <NavigationWindow id="photoListNav">
      <Window id="photoListWin" onClose="cleanup">
        <View class="body">
          <View class="navBar">
            <View class="navItems">
              <Label class="navTitle">写真一覧</Label>
              <Button class="addBtn" onSingletap="addPhoto" />
            </View>
          </View>
          <View class="container">
            <ListView id="photoListView" onItemclick="showPhotoDetail">
              <Templates>
                <ItemTemplate name="photoListTemplate" class="photoTemplate">
                  <View class="listItemContainer">
                    <View class="photoContainer">
                      <ImageView bindId="photo" class="photo" />
                    </View>
                    <View class="textContainer">
                      <Label bindId="name" class="name" />
                      <Label bindId="work" class="work" />
                      <Label bindId="date" class="date" />
                      <Label class="noteTitle">メモ:</Label>
                      <Label bindId="note" class="note" />
                    </View>
                  </View>
                </ItemTemplate>
              </Templates>
              <ListSection id="photoListSection"
                dataCollection="$.photoRecord"
                dataTransform="transformPhotoList"
                dataFilter="filterPhotoList"
                dataFunction="updatePhotoList" >
                <ListItem template="photoListTemplate"
                  photo:image="{photo}"
                  name:text="{name}"
                  work:text="{work}"
                  date:text="{date}"
                  note:text="{note}"
                  workValue="{workValue}"
                  dateValue="{dateValue}" >
                </ListItem>
              </ListSection>
            </ListView>
          </View>
        </View>

        <View id="photoDetailContainer">
          <View id="photoDetailTopOptionBtnContainer">
            <Button class="closeBtn" onSingletap="hidePhotoDetailView" />
          </View>
          <ScrollableView id="photoDetailScrollableView"
            dataCollection="$.photoRecord"
            dataTransform="transformPhotoDetail"
            dataFilter="filterPhotoDetail"
            dataFunction="updatePhotoDetail" >
            <View photoId="{photoId}">
              <Label class="photoDetailDate" text="{date}" />
              <Label class="photoDetailName" text="{name}" />
              <ScrollView class="photoDetailScroll" minZoomScale="{zoomScale}" zoomScale="{zoomScale}">
                <ImageView class="photoDetailImage" image="{photo}" />
              </ScrollView>
            </View>
          </ScrollableView>
          <View id="photoDetailBottomOptionBtnContainer">
            <Button class="optionBtn" onSingletap="deleteCrop" />
          </View>

          <View id="editPhotoContainer" onClick="hideKeyboard">
            <View class="body">
              <View class="navBar">
                <View class="navItems">
                  <Button class="backBtn" onSingletap="hideEditPhotoView" />
                  <Label class="navTitle">写真情報編集</Label>
                </View>
              </View>
              <View class="container">
                <View id="pickerView" visible="fasle">
                  <View id="toolbar">
                    <Button id="cancel" onClick="hidePicker" />
                    <Button id="done" onClick="doneClick" />
                  </View>
                  <Picker id="picker" onChange="getPickerValue">
                  </Picker>
                </View>

                <ScrollView class="editContainerScroll">
                  <View class="field">
                    <View class="input">
                      <TextField id="nameField" class="inputField" hintText="作物名を選択" onClick="setKeyboardOwner" />
                      <Button name="crop" class="dropBtn" onSingletap="openPicker"  />
                    </View>
                    <Button name="crop" class="resetBtn" onSingletap="resetValue" />
                  </View>

                  <View class="field">
                    <View class="input">
                      <TextField id="workField" class="inputField" hintText="農作業を選択" onClick="setKeyboardOwner" />
                      <Button name="work" class="dropBtn" onSingletap="openPicker"  />
                    </View>
                    <Button name="work" class="resetBtn" onSingletap="resetValue" />
                  </View>

                  <View class="inputAreaContainer">
                    <TextArea id="noteArea" class="inputArea" onClick="setKeyboardOwner" />
                  </View>
                  <Button id="saveBtn" onSingletap="updatePhotoData">写真情報を更新</Button>
                </ScrollView>
              </View>
            </View>
          </View>
        </View>

        <OptionDialog id="confirmDialog" onClick="confirmDeleteCrop" cancel="2" tintColor="#009900">
          <Options>
            <Option>写真情報を編集</Option>
            <Option>写真を削除</Option>
            <Option>キャンセル</Option>
          </Options>
        </OptionDialog>
      </Window>
    </NavigationWindow>
  </Tab>
</Alloy>
